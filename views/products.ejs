<!DOCTYPE html>
<html lang="pt-br">
<head>
    <%- include('partials/header') %>
    <link rel="stylesheet" type="text/css" href="/css/products.css">
</head>
<body>
    <%- include('partials/navbar') %>
    
    <main>
        <h1>Lista de Produtos</h1>
        <hr class="divider">
        <input type="text" id="search-bar" placeholder="Pesquise um produto" autocomplete="off">

        <section id="products-container">
            <% if (products && products.length > 0) { %>
                <% products.forEach(elem => { %>
                    <div class="product-card" data-name="<%= elem.name.toLowerCase() %>">
                        <h2 class="prod-name"><%= elem.name %></h2>
                        <p class="prod-description"><%= elem.description %></p>
                        <p class="prod-price">R$ <%= elem.price %></p>
                    </div>
                <% }) %>
            <% } else { %>
                <tr>
                    <p>Nenhum produto cadastrado...</p>
                </tr>
            <% } %>
        </section>
    </main>

    <script>
        document.getElementById('search-bar').addEventListener('input', function () {
            const searchTerm = this.value.toLowerCase();
            const products = document.querySelectorAll('#products-container .product-card');

            products.forEach(product => {
                const productName = product.getAttribute('data-name');
                if (productName.includes(searchTerm))
                    product.style.display = 'flex';
                else
                    product.style.display = 'none';
            });
        });

    </script>
</body>
</html>